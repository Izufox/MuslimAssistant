<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MuslimAssistant</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    rel="stylesheet"
  />
</head>
<style>
    .audio-controls {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
      margin-top: 50px;
    }
    .audio-controls i {
      font-size: 2rem;
      cursor: pointer;
      transition: transform 0.2s ease;
      background: none; /* Enlève le fond gris par défaut */
      border: none; /* Enlève les bordures */
      padding: 10px; /* Optionnel : Ajoute un peu de padding autour des icônes */
    }
    .audio-controls i:hover {
      color: #007bff;
    }
  </style>
<body>
    <a href="./"><h1>MuslimAssistant</h1></a>
    <h2>Lire le Coran</h2>

    <select id="sourateSelect" onchange="loadSourate()">
        <option value="">Choisir une sourate</option>
    </select>

    <div class="audio-controls">
        <i id="play-button" class="fas fa-play"></i>
        <i id="pause-button" class="fas fa-pause"></i>
        <i id="stop-button" class="fas fa-stop"></i>
    </div>


    <div class="verse-container" id="versesContainer"></div>

    <div class="verse-container" id="versesContainer"></div>
    
</body>
<script>

const playButton = document.getElementById("play-button");
const pauseButton = document.getElementById("pause-button");
const stopButton = document.getElementById("stop-button");

let coranData = {};
let currentSourateIndex = -1;
let audioUrl = ""

fetch('/api/coran')
.then(response => response.json())
.then(data => {
    coranData = data;
    populateSourateList();
})

const audio = new Audio();


function populateSourateList() {
    const sourateSelect = document.getElementById('sourateSelect');
    coranData.sourates.forEach((sourate, index) => {
        const option = document.createElement('option');
        option.value = index;
        option.textContent = sourate.nom_phonetique;
        sourateSelect.appendChild(option);
    });
}


function loadSourate() {
    const sourateSelect = document.getElementById('sourateSelect');
    const sourateIndex = parseInt(sourateSelect.value);

    if (isNaN(sourateIndex)) return;

    currentSourateIndex = sourateIndex;
    displaySourate();

    audioUrl = `https://github.com/The-Quran-Project/Quran-Audio/raw/refs/heads/main/Data/1/${currentSourateIndex + 1}.mp3`
}


function displaySourate() {
    if (currentSourateIndex === -1) return;

    const sourate = coranData.sourates[currentSourateIndex];

    const versesContainer = document.getElementById('versesContainer');
    versesContainer.innerHTML = ""; // Réinitialiser le contenu

    
    const sourateTitle = document.createElement('h2');
    sourateTitle.textContent = `Sourate : ${sourate.nom_phonetique}`;
    versesContainer.appendChild(sourateTitle);

    sourate.versets.forEach((verset, index) => {
        const verseElement = document.createElement('p');
        verseElement.innerHTML = `<strong> ${index + 1}. (Arabe):</strong> ${verset.text_arabe}<br><strong>Traduction:</strong> ${verset.text}`;
        versesContainer.appendChild(verseElement);
    });
}

playButton.addEventListener("click", () => {
    audioUrl = `https://github.com/The-Quran-Project/Quran-Audio/raw/refs/heads/main/Data/1/${currentSourateIndex + 1}.mp3`
    audio.src = audioUrl;  
    audio.play();
});

pauseButton.addEventListener("click", () => {
    
    if (audio.paused) {
        audio.play(); // Joue l'audio
    } else {
        
        audio.pause(); // met en pause l'audio
    }
});

stopButton.addEventListener("click", () => {
    audio.pause();
    audio.currentTime = 0;
});

</script>
</html>
